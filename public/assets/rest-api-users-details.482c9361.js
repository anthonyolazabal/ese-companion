import{D as W,m as V,n as I,r as S,o as h,p as b,w as t,g as e,q as a,s as Y,v as R,x as k,k as l,y as T,z as g,be as F,b7 as L,A as y,B as u,t as c,l as d,e as D,a5 as x,aB as v,aC as U,aD as q,f,aA as A,ay as _,az as w}from"./index.209e13e0.js";import{t as n}from"./form.b437509b.js";/* empty css              */import{h as N}from"./moment.9709ab41.js";import{V as j,a as E,b as M,c as B}from"./VWindowItem.f9465278.js";import{V as P}from"./VDialog.6aa2cfbb.js";import{V as z}from"./VSelect.b9a12590.js";import"./VSelectionControl.22916c9e.js";import"./VTextField.478887bd.js";import"./VChip.316b914b.js";const H={name:"DetailsRestApiUsers",data(){return{currentTab:W("Roles"),item:{},roles:[],addRole:!1,deleteRole:!1,selectedRole:{name:""},selectedRoleToDelete:{},permissions:[],addPermission:!1,deletePermission:!1,selectedPermission:{permission_string:""},selectedPermissionToDelete:{}}},methods:{formatDate(o){if(o)return N(String(o)).format("MM/DD/YYYY hh:mm")},async update(){this.item.username&&this.item.password?await this.$axios.put("/api/rest_api_user/"+this.$route.query.id,this.item).then(()=>{n("Rest Api user successfully updated",{type:"success",position:"bottom-center"})}).then(()=>{this.item={},V.push("/rest-api-users")}).catch(()=>{n("Error updating rest api user, contact your admin ! ",{type:"warning",position:"bottom-center"})}):n("Please fill all fields !",{type:"warning",position:"bottom-center"})},cancel(){V.push("/rest-api-users")},edit(){V.push("/rest-api-users-edit?id="+this.$route.query.id+"&return=details")},deleteUser(){V.push("/rest-api-users-delete?id="+this.$route.query.id)},async loadRoles(){this.addRole=!0,await this.$axios.get("/api/rest_api_roles").then(o=>{this.roles=o.data}).catch(o=>{n("Error loading roles, contact your admin ! Details : "+o.message,{type:"warning",position:"bottom-center"})})},async loadPermissions(){this.addPermission=!0,await this.$axios.get("/api/rest_api_permissions").then(o=>{this.permissions=o.data}).catch(o=>{n("Error loading permissions, contact your admin ! Details : "+o.message,{type:"warning",position:"bottom-center"})})},async assignRole(){if(this.selectedRole.id!=null){let o={user_id:this.$route.query.id,role_id:this.selectedRole.id};await this.$axios.post("/api/rest_api_user_role",o).then(s=>{n("Rest Api role assigned successfully",{type:"success",position:"bottom-center"}),this.addRole=!1}).then(async()=>{this.selectedRole={name:""},await this.$axios.get("/api/rest_api_user/"+this.$route.query.id+"?extend=true").then(s=>{this.item=s.data[0]}).catch(s=>{n("Error on assignment, contact your admin ! Details : "+s.message,{type:"warning",position:"bottom-center"})})}).catch(()=>{n("Error updating rest api user, contact your admin ! ",{type:"warning",position:"bottom-center"})})}else n("Please fill all fields !",{type:"warning",position:"bottom-center"})},async assignPermission(){if(this.selectedPermission.id!=null){let o={user_id:this.$route.query.id,permission:this.selectedPermission.id};await this.$axios.post("/api/rest_api_user_permission",o).then(s=>{n("Rest Api permission assigned successfully",{type:"success",position:"bottom-center"}),this.addPermission=!1}).then(async()=>{this.selectedPermission={permission_string:""},await this.$axios.get("/api/rest_api_user/"+this.$route.query.id+"?extend=true").then(s=>{this.item=s.data[0]}).catch(s=>{n("Error on assignment, contact your admin ! Details : "+s.message,{type:"warning",position:"bottom-center"})})}).catch(()=>{n("Error updating rest api user, contact your admin ! ",{type:"warning",position:"bottom-center"})})}else n("Please fill all fields !",{type:"warning",position:"bottom-center"})},deleteRoleWarning(o){this.deleteRole=!0,this.selectedRoleToDelete=o},deletePermissionWarning(o){this.deletePermission=!0,this.selectedPermissionToDelete=o},async deleteRoleAssignment(){await this.$axios.delete("/api/rest_api_user_role/"+this.$route.query.id+"/"+this.selectedRoleToDelete.id).then(()=>{n("Rest Api role unassigned successfully",{type:"success",position:"bottom-center"}),this.deleteRole=!1}).then(async()=>{this.selectedRoleToDelete={name:""},await this.$axios.get("/api/rest_api_user/"+this.$route.query.id+"?extend=true").then(o=>{this.item=o.data[0]}).catch(o=>{n("Error on delete, contact your admin ! Details : "+o.message,{type:"warning",position:"bottom-center"})})}).catch(()=>{n("Error unassigning rest api role to user, contact your admin ! ",{type:"warning",position:"bottom-center"})})},async deletePermissionAssignment(){await this.$axios.delete("/api/rest_api_user_permission/"+this.$route.query.id+"/"+this.selectedPermissionToDelete.id).then(()=>{n("Rest Api permission unassigned successfully",{type:"success",position:"bottom-center"}),this.deletePermission=!1}).then(async()=>{this.selectedPermissionToDelete={permission_string:""},await this.$axios.get("/api/rest_api_user/"+this.$route.query.id+"?extend=true").then(o=>{this.item=o.data[0]}).catch(o=>{n("Error on delete, contact your admin ! Details : "+o.message,{type:"warning",position:"bottom-center"})})}).catch(()=>{n("Error unassigning rest api permission to user, contact your admin ! ",{type:"warning",position:"bottom-center"})})}},async mounted(){await this.$axios.get("/api/rest_api_user/"+this.$route.query.id+"?extend=true").then(o=>{this.item=o.data[0]}).catch(o=>{n("Error loading the page, contact your admin ! Details : "+o.message,{type:"warning",position:"bottom-center"})})}},G=f("b",null,"Username ",-1),J=f("b",null,"Password ",-1),K=f("b",null,"Algorithm ",-1),O=f("b",null,"Iterations ",-1),Q=f("b",null,"Created ",-1),X=f("b",null,"Updated",-1),Z=f("b",null,"Permission",-1),$=f("b",null,"Description",-1);function ee(o,s,te,se,i,m){const C=S("RouterLink");return h(),b(u,null,{default:t(()=>[e(a,{cols:"12",md:"12"},{default:t(()=>[e(Y,null,{prepend:t(()=>[e(R,{size:"small",icon:"mdi-home"})]),default:t(()=>[e(k,null,{default:t(()=>[e(C,{to:"/"},{default:t(()=>[l("Home")]),_:1})]),_:1}),e(T,null,{default:t(()=>[l(" / ")]),_:1}),e(k,null,{default:t(()=>[e(C,{to:"/rest-api-users"},{default:t(()=>[l(" Rest Api Users ")]),_:1})]),_:1}),e(T,null,{default:t(()=>[l(" / ")]),_:1}),e(k,null,{default:t(()=>[e(C,{to:"/rest-api-users-details?id"+o.$route.query.id},{default:t(()=>[l(" User Details ")]),_:1},8,["to"])]),_:1})]),_:1})]),_:1}),e(a,{cols:"4"},{default:t(()=>[e(g,{title:"Rest Api user details"},{default:t(()=>[e(F,{class:"text-center"},{default:t(()=>[e(L,{color:"primary",icon:"mdi-account",size:"x-large"})]),_:1}),e(y,null,{default:t(()=>[e(u,null,{default:t(()=>[e(a,{cols:"12",md:"4"},{default:t(()=>[G]),_:1}),e(a,{cols:"12",md:"8",class:"text-right"},{default:t(()=>[l(c(i.item.username),1)]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(a,{cols:"12",md:"4"},{default:t(()=>[J]),_:1}),e(a,{cols:"12",md:"8",class:"text-right"},{default:t(()=>[l(" ****************** ")]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(a,{cols:"12",md:"4"},{default:t(()=>[K]),_:1}),e(a,{cols:"12",md:"8",class:"text-right"},{default:t(()=>[l(c(i.item.algorithm),1)]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(a,{cols:"12",md:"4"},{default:t(()=>[O]),_:1}),e(a,{cols:"12",md:"8",class:"text-right"},{default:t(()=>[l(c(i.item.password_iterations),1)]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(a,{cols:"12",md:"4"},{default:t(()=>[Q]),_:1}),e(a,{cols:"12",md:"8",class:"text-right"},{default:t(()=>[l(c(m.formatDate(i.item.created_at)),1)]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(a,{cols:"12",md:"4"},{default:t(()=>[X]),_:1}),e(a,{cols:"12",md:"8",class:"text-right"},{default:t(()=>[l(c(m.formatDate(i.item.updated_at)),1)]),_:1})]),_:1})]),_:1}),e(y,null,{default:t(()=>[e(u,null,{default:t(()=>[e(a,{cols:"12",md:"12"},{default:t(()=>[e(d,{color:"secondary",variant:"tonal",onClick:m.cancel,block:""},{default:t(()=>[l(" Back to role list ")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(a,{cols:"12",md:"12"},{default:t(()=>[e(d,{color:"primary",variant:"tonal",onClick:m.edit,block:""},{default:t(()=>[l(" Edit user properties ")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(u,null,{default:t(()=>[e(a,{cols:"12",md:"12"},{default:t(()=>[e(d,{color:"error",variant:"tonal",onClick:m.deleteUser,block:""},{default:t(()=>[l(" Delete user ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(a,{cols:"8"},{default:t(()=>[e(j,{"align-tabs":"center",modelValue:i.currentTab,"onUpdate:modelValue":s[0]||(s[0]=r=>i.currentTab=r),grow:""},{default:t(()=>[e(E,{value:"Roles"},{default:t(()=>[e(R,{icon:"mdi-key-link"}),l(" Assigned Roles ")]),_:1}),e(E,{value:"Permissions"},{default:t(()=>[e(R,{icon:"mdi-key"}),l(" Direct permissions ")]),_:1})]),_:1},8,["modelValue"]),e(M,{modelValue:i.currentTab,"onUpdate:modelValue":s[15]||(s[15]=r=>i.currentTab=r),class:"mt-5"},{default:t(()=>[e(B,{value:"Roles"},{default:t(()=>[e(g,null,{default:t(()=>[(h(!0),D(x,null,v(i.item.rest_api_user_roles,r=>(h(),b(u,null,{default:t(()=>[e(a,{cols:"12",md:"12"},{default:t(()=>[e(y,null,{default:t(()=>[e(U,null,{default:t(()=>[e(q,{style:{"margin-left":"10px"}},{default:t(()=>[f("b",null,c(r.rest_api_roles.name.toUpperCase()),1),l(" ("+c(r.rest_api_roles.description)+") ",1)]),_:2},1024),e(A),e(d,{icon:"",color:"#F05635"},{default:t(()=>[e(R,{onClick:p=>m.deleteRoleWarning(r.rest_api_roles)},{default:t(()=>[l("mdi-delete")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),e(P,{modelValue:i.deleteRole,"onUpdate:modelValue":s[3]||(s[3]=p=>i.deleteRole=p),width:"auto"},{default:t(()=>[e(g,null,{default:t(()=>[e(_,null,{default:t(()=>[l(" Are you sure that you want to remove the assignment of "+c(i.selectedRoleToDelete.name)+" ? ",1)]),_:1}),e(w,null,{default:t(()=>[e(d,{color:"alert",onClick:s[1]||(s[1]=p=>m.deleteRoleAssignment())},{default:t(()=>[l("Remove role")]),_:1}),e(d,{color:"secondary",onClick:s[2]||(s[2]=p=>{i.deleteRole=!1,i.selectedRoleToDelete={}})},{default:t(()=>[l("Cancel")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:2},1024),e(_,null,{default:t(()=>[e(u,null,{default:t(()=>[e(a,{cols:"12",md:"4"},{default:t(()=>[Z]),_:1}),e(a,{cols:"12",md:"8"},{default:t(()=>[$]),_:1})]),_:1})]),_:1}),(h(!0),D(x,null,v(r.rest_api_roles.rest_api_role_permissions,p=>(h(),b(_,null,{default:t(()=>[e(u,null,{default:t(()=>[e(A),e(a,{cols:"12",md:"4"},{default:t(()=>[l(c(p.rest_api_permissions.permission_string),1)]),_:2},1024),e(a,{cols:"12",md:"8"},{default:t(()=>[l(c(p.rest_api_permissions.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:2},1024)]),_:2},1024))),256)),e(u,null,{default:t(()=>[e(a,null,{default:t(()=>[e(y,null,{default:t(()=>[e(d,{variant:"outlined",size:"small",onClick:s[4]||(s[4]=r=>m.loadRoles())},{default:t(()=>[l(" Assign new rest api role ")]),_:1}),e(P,{modelValue:i.addRole,"onUpdate:modelValue":s[7]||(s[7]=r=>i.addRole=r),width:"auto"},{default:t(()=>[e(g,null,{default:t(()=>[e(_,null,{default:t(()=>[l(" Pick the role to assign to user ")]),_:1}),e(_,null,{default:t(()=>[e(z,{modelValue:i.selectedRole,"onUpdate:modelValue":s[5]||(s[5]=r=>i.selectedRole=r),items:i.roles,"item-title":"name","item-value":"id","return-object":!0,variant:"outlined",placeholder:"selectedRole",hint:`${i.selectedRole.description}`},null,8,["modelValue","items","hint"])]),_:1}),e(w,null,{default:t(()=>[e(d,{color:"primary",onClick:m.assignRole},{default:t(()=>[l("Assign role")]),_:1},8,["onClick"]),e(d,{color:"secondary",onClick:s[6]||(s[6]=r=>i.addRole=!1)},{default:t(()=>[l("Cancel")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(B,{value:"Permissions"},{default:t(()=>[e(g,null,{default:t(()=>[(h(!0),D(x,null,v(i.item.rest_api_user_permissions,r=>(h(),b(u,null,{default:t(()=>[e(a,{cols:"12",md:"12"},{default:t(()=>[e(y,null,{default:t(()=>[e(U,null,{default:t(()=>[e(q,{style:{"margin-left":"10px"}},{default:t(()=>[l(c(r.rest_api_permissions.permission_string.toUpperCase()),1)]),_:2},1024),e(A),e(d,{icon:"",color:"#F05635"},{default:t(()=>[e(R,{onClick:p=>m.deletePermissionWarning(r.rest_api_permissions)},{default:t(()=>[l("mdi-delete")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),e(_,null,{default:t(()=>[l(c(r.rest_api_permissions.description),1)]),_:2},1024),e(P,{modelValue:i.deletePermission,"onUpdate:modelValue":s[10]||(s[10]=p=>i.deletePermission=p),width:"auto"},{default:t(()=>[e(g,null,{default:t(()=>[e(_,null,{default:t(()=>[l(" Are you sure that you want to remove the assignment of "+c(i.selectedPermissionToDelete.permission_string)+" ? ",1)]),_:1}),e(w,null,{default:t(()=>[e(d,{color:"alert",onClick:s[8]||(s[8]=p=>m.deletePermissionAssignment())},{default:t(()=>[l("Remove role")]),_:1}),e(d,{color:"secondary",onClick:s[9]||(s[9]=p=>{i.deletePermission=!1,i.selectedPermissionToDelete={}})},{default:t(()=>[l("Cancel")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256)),e(u,null,{default:t(()=>[e(a,null,{default:t(()=>[e(y,null,{default:t(()=>[e(d,{variant:"outlined",size:"small",onClick:s[11]||(s[11]=r=>m.loadPermissions())},{default:t(()=>[l(" Assign new rest api permission ")]),_:1}),e(P,{modelValue:i.addPermission,"onUpdate:modelValue":s[14]||(s[14]=r=>i.addPermission=r),width:"auto"},{default:t(()=>[e(g,null,{default:t(()=>[e(_,null,{default:t(()=>[l(" Pick the permission to assign to user ")]),_:1}),e(_,null,{default:t(()=>[e(z,{modelValue:i.selectedPermission,"onUpdate:modelValue":s[12]||(s[12]=r=>i.selectedPermission=r),items:i.permissions,"item-title":"permission_string","item-value":"id","return-object":!0,variant:"outlined",placeholder:"selectedRole",hint:`${i.selectedPermission.description}`},null,8,["modelValue","items","hint"])]),_:1}),e(w,null,{default:t(()=>[e(d,{color:"primary",onClick:m.assignPermission},{default:t(()=>[l("Assign permission")]),_:1},8,["onClick"]),e(d,{color:"secondary",onClick:s[13]||(s[13]=r=>i.addPermission=!1)},{default:t(()=>[l("Cancel")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}const pe=I(H,[["render",ee]]);export{pe as default};
