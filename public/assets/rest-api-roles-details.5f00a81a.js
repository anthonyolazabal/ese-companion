import{m as y,n as R,r as A,o as P,p as b,w as t,g as e,q as r,s as B,v as w,x as V,k as i,y as x,z as f,A as C,B as d,t as c,az as D,l as u,aA as k,e as q,a5 as T,aB as E,aC as z,aD as L,f as p,ay as g}from"./index.998ab70e.js";import{t as m}from"./form.77a082ea.js";/* empty css              */import{h as N}from"./moment.9709ab41.js";import{V as v}from"./VDialog.a28bbb96.js";import{V as S}from"./VSelect.f852e1e4.js";import"./VSelectionControl.06cd081e.js";import"./VTextField.16466e2b.js";import"./VChip.3c763cc4.js";const U={name:"DetailsRestApiRoles",data(){return{item:{},permissions:[],addPermission:!1,deletePermission:!1,selectedPermission:{permission_string:""},selectedPermissionToDelete:{}}},methods:{formatDate(s){if(s)return N(String(s)).format("MM/DD/YYYY hh:mm")},cancel(){y.push("/rest-api-roles")},edit(){y.push("/rest-api-roles-edit?id="+this.$route.query.id+"&return=details")},deleteRole(){y.push("/rest-api-roles-delete?id="+this.$route.query.id)},async loadPermissions(){this.addPermission=!0,await this.$axios.get("/api/rest_api_permissions").then(s=>{this.permissions=s.data}).catch(s=>{m("Error loading permissions, contact your admin ! Details : "+s.message,{type:"warning",position:"bottom-center"})})},async assignPermission(){if(this.selectedPermission.id!=null){let s={role:this.$route.query.id,permission:this.selectedPermission.id};await this.$axios.post("/api/rest_api_role_permission",s).then(l=>{m("Rest Api permission assigned successfully",{type:"success",position:"bottom-center"}),this.addPermission=!1}).then(async()=>{this.selectedPermission={permission_string:""},await this.$axios.get("/api/rest_api_role/"+this.$route.query.id+"?extend=true").then(l=>{this.item=l.data[0]}).catch(l=>{m("Error assigning permission, contact your admin ! Details : "+l.message,{type:"warning",position:"bottom-center"})})}).catch(()=>{m("Error updating rest api role, contact your admin ! ",{type:"warning",position:"bottom-center"})})}else m("Please fill all fields !",{type:"warning",position:"bottom-center"})},deleteWarning(s){this.deletePermission=!0,this.selectedPermissionToDelete=s},async deleteAssignment(){await this.$axios.delete("/api/rest_api_role_permission/"+this.$route.query.id+"/"+this.selectedPermissionToDelete.id).then(s=>{m("Rest Api permission unassigned successfully",{type:"success",position:"bottom-center"}),this.deletePermission=!1}).then(async()=>{this.selectedPermissionToDelete={permission_string:""},await this.$axios.get("/api/rest_api_role/"+this.$route.query.id+"?extend=true").then(s=>{this.item=s.data[0]}).catch(s=>{m("Error deleting assignment, contact your admin ! Details : "+s.message,{type:"warning",position:"bottom-center"})})}).catch(()=>{m("Error unassigning permission to rest api role, contact your admin ! ",{type:"warning",position:"bottom-center"})})}},async mounted(){await this.$axios.get("/api/rest_api_role/"+this.$route.query.id+"?extend=true").then(s=>{this.item=s.data[0]}).catch(s=>{m("Error loading the page, contact your admin ! Details : "+s.message,{type:"warning",position:"bottom-center"})})}},Y=p("b",null,"Name ",-1),I=p("b",null,"Description ",-1),F=p("b",null,"Created ",-1),M=p("b",null,"Last updated ",-1);function W(s,l,j,H,o,a){const h=A("RouterLink");return P(),b(d,null,{default:t(()=>[e(r,{cols:"12",md:"12"},{default:t(()=>[e(B,null,{prepend:t(()=>[e(w,{size:"small",icon:"mdi-home"})]),default:t(()=>[e(V,null,{default:t(()=>[e(h,{to:"/"},{default:t(()=>[i("Home")]),_:1})]),_:1}),e(x,null,{default:t(()=>[i(" / ")]),_:1}),e(V,null,{default:t(()=>[e(h,{to:"/rest-api-roles"},{default:t(()=>[i(" Rest Api Roles ")]),_:1})]),_:1}),e(x,null,{default:t(()=>[i(" / ")]),_:1}),e(V,null,{default:t(()=>[e(h,{to:"/rest-api-roles-details?id"+s.$route.query.id},{default:t(()=>[i(" Role Details ")]),_:1},8,["to"])]),_:1})]),_:1})]),_:1}),e(r,{cols:"12"},{default:t(()=>[e(f,{title:"Rest Api role details"},{default:t(()=>[e(C,null,{default:t(()=>[e(d,{style:{"margin-top":"2px"}},{default:t(()=>[e(r,{cols:"12",md:"6"},{default:t(()=>[e(d,null,{default:t(()=>[e(r,{cols:"12",md:"6"},{default:t(()=>[Y]),_:1}),e(r,{cols:"12",md:"6"},{default:t(()=>[i(c(o.item.name),1)]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(r,{cols:"12",md:"6"},{default:t(()=>[I]),_:1}),e(r,{cols:"12",md:"6"},{default:t(()=>[i(c(o.item.description),1)]),_:1})]),_:1})]),_:1}),e(r,{cols:"12",md:"6"},{default:t(()=>[e(d,null,{default:t(()=>[e(r,{cols:"12",md:"6"},{default:t(()=>[F]),_:1}),e(r,{cols:"12",md:"6",class:"text-right"},{default:t(()=>[i(c(a.formatDate(o.item.created_at)),1)]),_:1})]),_:1}),e(d,null,{default:t(()=>[e(r,{cols:"12",md:"6"},{default:t(()=>[M]),_:1}),e(r,{cols:"12",md:"6",class:"text-right"},{default:t(()=>[i(c(a.formatDate(o.item.updated_at)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(D,null,{default:t(()=>[e(u,{color:"secondary",variant:"tonal",onClick:a.cancel},{default:t(()=>[i(" Back to role list ")]),_:1},8,["onClick"]),e(k,{class:"border-opacity-0"}),e(u,{color:"primary",variant:"tonal",onClick:a.edit},{default:t(()=>[i(" Edit role properties ")]),_:1},8,["onClick"]),e(k,{class:"border-opacity-0"}),e(u,{color:"error",variant:"tonal",onClick:a.deleteRole},{default:t(()=>[i(" Delete role ")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(f,{title:"Assigned permissions",style:{"margin-top":"10px"}},{default:t(()=>[(P(!0),q(T,null,E(o.item.rest_api_role_permissions,n=>(P(),b(d,null,{default:t(()=>[e(r,{cols:"12",md:"12"},{default:t(()=>[e(C,null,{default:t(()=>[e(z,null,{default:t(()=>[e(L,{style:{"margin-left":"10px"}},{default:t(()=>[p("b",null,c(n.rest_api_permissions.permission_string.toUpperCase()),1)]),_:2},1024),e(k),e(u,{icon:"",color:"#F05635"},{default:t(()=>[e(w,{onClick:_=>a.deleteWarning(n.rest_api_permissions)},{default:t(()=>[i("mdi-delete")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),e(v,{modelValue:o.deletePermission,"onUpdate:modelValue":l[2]||(l[2]=_=>o.deletePermission=_),width:"auto"},{default:t(()=>[e(f,null,{default:t(()=>[e(g,null,{default:t(()=>[i(" Are you sure that you want to remove the permission : "+c(o.selectedPermissionToDelete.permission_string)+" ? ",1)]),_:1}),e(D,null,{default:t(()=>[e(u,{color:"alert",onClick:l[0]||(l[0]=_=>a.deleteAssignment())},{default:t(()=>[i("Remove role")]),_:1}),e(u,{color:"secondary",onClick:l[1]||(l[1]=_=>{o.deletePermission=!1,o.selectedPermissionToDelete={}})},{default:t(()=>[i("Cancel")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:2},1024),e(g,null,{default:t(()=>[e(d,null,{default:t(()=>[e(r,{cols:"12",md:"12"},{default:t(()=>[p("i",null,c(n.rest_api_permissions.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256)),e(d,null,{default:t(()=>[e(r,null,{default:t(()=>[e(C,null,{default:t(()=>[e(u,{variant:"outlined",size:"small",onClick:l[3]||(l[3]=n=>a.loadPermissions())},{default:t(()=>[i(" Assign new permission ")]),_:1}),e(v,{modelValue:o.addPermission,"onUpdate:modelValue":l[6]||(l[6]=n=>o.addPermission=n),width:"auto"},{default:t(()=>[e(f,null,{default:t(()=>[e(g,null,{default:t(()=>[i(" Pick the permission to assign to role ")]),_:1}),e(g,null,{default:t(()=>[e(S,{modelValue:o.selectedPermission,"onUpdate:modelValue":l[4]||(l[4]=n=>o.selectedPermission=n),items:o.permissions,"item-title":"permission_string","item-value":"id","return-object":!0,variant:"outlined",placeholder:"selectedRole",hint:`Description : ${o.selectedPermission.description}`},null,8,["modelValue","items","hint"])]),_:1}),e(D,null,{default:t(()=>[e(u,{color:"primary",onClick:a.assignPermission},{default:t(()=>[i("Assign permission")]),_:1},8,["onClick"]),e(u,{color:"secondary",onClick:l[5]||(l[5]=n=>o.addPermission=!1)},{default:t(()=>[i("Cancel")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const te=R(U,[["render",W]]);export{te as default};
